# POS Dashboard – Project Architecture Overview

## 1. Overview

A modern, modular dashboard built with Next.js 15, Drizzle ORM, TanStack Query, Supabase Auth, and TypeScript. The architecture is designed for type safety, maintainability, and scalable user management.

---

## 2. High-Level Structure

```
/ (root)
├── app/                # Next.js App Router (pages, layouts, API routes)
├── components/         # Shared UI components (shadcn/ui, Navbar, etc.)
├── modules/            # Feature modules (user management, providers)
├── lib/                # Business logic, Drizzle ORM, validation
├── utils/              # Supabase clients, helpers
├── public/             # Static assets
├── supabase/           # DB config, migrations, seed
├── docs/               # Documentation
└── ...                 # Config, scripts, etc.
```

---

## 3. Key Technologies

- **Next.js 15** (App Router, SSR, API routes)
- **Drizzle ORM** (type-safe DB access, migrations)
- **TanStack Query** (data fetching, caching, SSR hydration)
- **Supabase Auth** (RBAC, JWT, session management)
- **TypeScript** (type safety everywhere)
- **shadcn/ui + Tailwind CSS** (UI components)

---

## 4. Modular Feature Example: User Management

```
modules/
└── user-management/
    ├── components/
    │   ├── create-user-form.tsx
    │   ├── edit-user-dialog.tsx
    │   ├── users-table.tsx
    │   └── users-page-content.tsx
    ├── hooks/
    │   └── use-users.ts
    └── index.ts
```

- **Hooks**: All data fetching/mutations use TanStack Query, fully type-safe.
- **Components**: UI is modular, feature-scoped, and reusable.

---

## 5. Data Flow & API

- **API routes** (`/app/api/users/`):
  - `/api/users` (GET, POST): List/create users
  - `/api/users/[id]` (GET, PATCH, DELETE): Get/update/delete user
- **Drizzle ORM**: All DB access is via Drizzle, with full type safety.
- **React Query**: All client/server data fetching uses TanStack Query hooks, with SSR hydration.

---

## 6. Auth & RBAC

- **Supabase Auth**: Handles login, JWT, and user sessions
- **Role-based access**: Navbar and routes are protected by role (superadmin, admin, etc.)
- **Middleware**: Route protection via Next.js middleware and server-side checks

---

## 7. Database

- **Drizzle schema**: `/lib/db/schema.ts` defines all tables and enums
- **Migrations**: `/supabase/migrations/` managed by Drizzle Kit
- **Seed data**: `/supabase/seed.sql` for initial users/roles

---

## 8. UI & Theming

- **shadcn/ui**: Modern, accessible UI components
- **Tailwind CSS**: Utility-first styling
- **ThemeProvider**: Light/dark mode support

---

## 9. Example: User CRUD Flow

1. **User visits `/admin/users`**
2. **SSR**: Server checks role, fetches user list via Drizzle
3. **Client**: TanStack Query hydrates, enables mutations (create, edit, delete)
4. **API**: All mutations go through `/api/users` routes, which use Drizzle ORM
5. **UI**: Modular components update optimistically, errors handled gracefully

---

## 10. Extensibility

- Add new features as modules in `/modules/`
- Add new API endpoints in `/app/api/`
- Extend DB schema in `/lib/db/schema.ts`
- Add new UI components in `/components/ui/`

---

## 11. Dev & Ops

- **Local dev**: `npm run dev`, `supabase start`
- **Build**: `npm run build`
- **DB**: `supabase db reset --local`, `supabase studio`
- **Env**: `.env.local` for secrets/keys

---

## 12. Project Status

- ✅ Modern, modular, type-safe
- ✅ All legacy code removed
- ✅ Ready for production & extension

---

_Generated by GitHub Copilot, June 2025._
